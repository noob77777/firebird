(this["webpackJsonpfirebird-react"]=this["webpackJsonpfirebird-react"]||[]).push([[0],{14:function(e,t,n){e.exports={border:"Login_border__1D4hz",Login:"Login_Login__WctD9",loginContainer:"Login_loginContainer__2sYHN",loginForm:"Login_loginForm__2Maah",formMain:"Login_formMain__3rcaN",loginHeader:"Login_loginHeader__12uTQ",banner:"Login_banner__ZQscA",error:"Login_error__1hpMK",submitbtn:"Login_submitbtn__2BgvP"}},140:function(e,t,n){},148:function(e,t){},150:function(e,t){},160:function(e,t){},162:function(e,t){},189:function(e,t){},191:function(e,t){},192:function(e,t){},197:function(e,t){},199:function(e,t){},205:function(e,t){},207:function(e,t){},226:function(e,t){},238:function(e,t){},241:function(e,t){},278:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n.n(a),s=n(133),c=n.n(s),i=(n(140),n(35)),o=n(10),l="user.",u=".private.key",b=".public.key",d={LOAD_RSA_KEYS:"LOAD_RSA_KEYS",SIGN_IN:"SIGN_IN",SIGN_UP:"SIGN_UP"},h=n(1),j={auth:{userName:null,sessionKey:null,privateKey:null,publicKey:null,hash:null},contacts:[],currentReceiver:null},p=Object(a.createContext)({state:j,dispatch:function(){return null}}),f=function(e,t){switch(t.type){case d.SIGN_UP:return localStorage.setItem(t.payload.userName+u,t.payload.auth.privateKey),localStorage.setItem(t.payload.userName+b,t.payload.auth.publicKey),Object(o.a)(Object(o.a)({},e),{},{auth:Object(o.a)(Object(o.a)({},e.auth),t.payload.auth)});case d.LOAD_RSA_KEYS:case d.SIGN_IN:return Object(o.a)(Object(o.a)({},e),{},{auth:Object(o.a)(Object(o.a)({},e.auth),t.payload)});default:return e}},g=function(e){var t=Object(a.useReducer)(f,j),n=Object(i.a)(t,2),r=n[0],s=n[1];return Object(h.jsx)(p.Provider,{value:{state:r,dispatch:s},children:e.children})},m=p,x=n(36),O=n.n(x),v=n(69),y=n(134),_=n.n(y),N=n(9),S=n.n(N),K=n(14),k=n.n(K),w=n(135),I=n.n(w).a.create({baseURL:"http://localhost:8080",timeout:1e3}),L=function(){var e=Object(a.useContext)(m),t=e.state,n=e.dispatch,r=Object(a.useState)(""),s=Object(i.a)(r,2),c=s[0],o=s[1],j=Object(a.useState)(""),p=Object(i.a)(j,2),f=p[0],g=p[1];Object(a.useEffect)((function(){var e=localStorage.getItem(l+c+u),t=localStorage.getItem(l+c+b);if(e&&t){var a=S.a.createHash("sha256").update(e).digest("hex");n({type:d.LOAD_RSA_KEYS,payload:{privateKey:e,publicKey:t,hash:a}})}else n({type:d.LOAD_RSA_KEYS,payload:{privateKey:null,publicKey:null,hash:null}})}),[n,c]);var x=function(){var e=Object(v.a)(O.a.mark((function e(a){var r,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),g(""),!(r=t.auth.hash)){e.next=27;break}return e.prev=4,g("Signing you in..."),e.next=8,I.post("/api/validateUser",{userName:l+c,hash:r});case 8:s=e.sent,n({type:d.SIGN_IN,payload:{userName:s.data.userName,sessionKey:s.data.sessionKey}}),g(""),e.next=25;break;case 13:if(e.prev=13,e.t0=e.catch(4),!e.t0.response){e.next=24;break}e.t1=e.t0.response.status,e.next=401===e.t1?19:21;break;case 19:return g("Authentication failed"),e.abrupt("break",22);case 21:g("Something went wrong. Try again");case 22:e.next=25;break;case 24:g("Could not contact server. Try again");case 25:e.next=28;break;case 27:g("RSA credentials not found in local storage");case 28:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(v.a)(O.a.mark((function e(t){var a,r,s,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),g(""),a=new _.a({b:512}),r=a.exportKey("public"),s=a.exportKey("private"),i=S.a.createHash("sha256").update(s).digest("hex"),e.prev=6,g("Creating new user..."),e.next=10,I.post("/api/createUser",{userName:l+c,hash:i,publicKey:r});case 10:o=e.sent,n({type:d.SIGN_UP,payload:{auth:{privateKey:s,publicKey:r,hash:i},userName:o.data.userName}}),g("User created"),e.next=27;break;case 15:if(e.prev=15,e.t0=e.catch(6),!e.t0.response){e.next=26;break}e.t1=e.t0.response.status,e.next=401===e.t1?21:23;break;case 21:return g("User already exists"),e.abrupt("break",24);case 23:g("Something went wrong. Try again");case 24:e.next=27;break;case 26:g("Could not contact server. Try again.");case 27:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)("div",{className:k.a.Login,children:Object(h.jsxs)("div",{className:k.a.loginContainer+" row",children:[Object(h.jsx)("div",{className:k.a.banner+" col l8 m6 s1 valign-wrapper",children:Object(h.jsxs)("div",{className:"col m11 offset-m1 hide-on-small-only",children:[Object(h.jsx)("h1",{children:"Introducing firebird."}),Object(h.jsx)("h5",{children:"A Fast end-to-end Encrypted Messenger"}),Object(h.jsxs)("p",{children:["No more remembering passwords. ",Object(h.jsx)("br",{}),"Password-less authentication using asymmetric key pairs for one tap ",Object(h.jsx)("br",{}),"login and signing up. ",Object(h.jsx)("br",{})]}),Object(h.jsxs)("p",{children:["All user information is persisted client-side. ",Object(h.jsx)("br",{})]})]})}),Object(h.jsx)("div",{className:k.a.loginForm+" col l4 m6 s11 valign-wrapper",children:Object(h.jsxs)("form",{className:k.a.formMain,children:[Object(h.jsxs)("div",{className:k.a.loginHeader+" row",children:[Object(h.jsx)("h1",{children:"firebird"}),Object(h.jsx)("h6",{children:"Secured by RSA end-to-end Encryption"})]}),Object(h.jsx)("div",{className:"row",children:Object(h.jsxs)("div",{className:"input-field col s8 offset-s2",children:[Object(h.jsx)("input",{id:"user",type:"text",className:"validate",onChange:function(e){o(e.target.value),g("")},value:c}),Object(h.jsx)("label",{htmlFor:"user",children:"Username: "}),Object(h.jsx)("span",{className:k.a.error+" helper-text",children:f})]})}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col s4 offset-s2 center",children:Object(h.jsx)("button",{className:k.a.submitbtn+" btn",onClick:x,children:"Sign In"})}),Object(h.jsx)("div",{className:"col s4 center",children:Object(h.jsx)("button",{className:k.a.submitbtn+" btn",onClick:y,children:"Sign Up"})})]})]})})]})})},A=function(){return Object(h.jsx)(h.Fragment,{})},C=function(){var e=Object(a.useContext)(m).state;return Object(h.jsx)(h.Fragment,{children:e.auth.sessionKey?Object(h.jsx)(A,{}):Object(h.jsx)(L,{})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,279)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))};c.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(g,{children:Object(h.jsx)(C,{})})}),document.getElementById("root")),F()}},[[278,1,2]]]);
//# sourceMappingURL=main.b82d854d.chunk.js.map