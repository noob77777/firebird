{"version":3,"sources":["Components/Messenger/Contacts/Contacts.module.scss","Components/Messenger/MessengerMain/MessengerMain.module.scss","Components/Notifier/Notifier.module.scss","Components/Login/Login.module.scss","Components/Messenger/Messenger.module.scss","constants.ts","API/API.ts","Components/Notifier/Notifier.tsx","FirebirdContext/ActionTypes.ts","Components/Messenger/MessengerMain/MessengerMain.tsx","FirebirdContext/FirebirdContext.tsx","Components/Login/Login.tsx","Components/Messenger/Contacts/Contacts.tsx","Components/Messenger/Messenger.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["module","exports","FIREBIRD_SERVER","USER_PREFIX","GROUP_PREFIX","PRIVATE_KEY_SUFFIX","PUBLIC_KEY_SUFFIX","CONTACTS_SUFFIX","SESSION_KEY","TYPE_TEXT","TYPE_IMAGE","MESSAGE_PENDING","MESSAGE_SENT","MESSAGE_FAILED","API","axios","create","baseURL","timeout","modal","open","set","text","customStyles","content","top","left","right","bottom","marginRight","transform","overlay","backgroundColor","Modal","setAppElement","modalNotify","Notifier","useState","modalIsOpen","setIsOpen","setText","isOpen","onRequestClose","style","contentLabel","className","styles","ActionTypes","LOAD_RSA_KEYS","SIGN_IN","SIGN_UP","LOAD_USER_LOCAL_STATE","UPDATE_CONTACTS","SET_RECEIVER","LOGOUT","NEW_MESSAGE","SEND_NEW_MESSAGE","SET_ACK_FLAG","socket","io","transports","encrypt","message","publicKey","receiver","startsWith","type","key","NodeRSA","importKey","res","body","err","addMessages","contacts","messages","privateKey","sent","forEach","idx","findIndex","contact","isGroup","user","groupName","newGroup","members","push","unread","decrypt","isUser","userName","sender","newUser","active","MessengerMain","useContext","FirebirdContext","state","dispatch","file","setFile","useEffect","element","document","getElementById","scrollTop","scrollHeight","updateScroll","userPresent","currentReceiver","filter","length","userActive","sendMessage","data","timestamp","Date","now","id","crypto","createHash","update","auth","digest","status","emit","JSON","stringify","sessionKey","undefined","payload","connected","connect","on","parse","console","log","close","a","get","messageList","localStorage","getItem","updatedContacts","response","getPendingMessages","reader","FileReader","addEventListener","result","toString","header","replace","activeIconMargin","data-position","data-tooltip","scroll","Map","map","item","values","MessageViewInner","icon","image","src","alt","toISOString","MessageView","reimage","empty","ncscenter","input","value","onChange","e","target","onKeyDown","htmlFor","onClick","hidden","files","readAsDataURL","btn","click","o","initState","hash","createContext","FirebirdContextReducer","action","setItem","contactsNM","contactsSNM","contactsSAF","sessionStorage","removeItem","FirebirdContextProvider","props","useReducer","Provider","children","Login","setUserName","errorMessage","setErrorMessage","onSignIn","preventDefault","post","onSignUp","NodeRsa","b","exportKey","loginContainer","banner","loginForm","formMain","loginHeader","error","submitbtn","sortOrder","filteredContacts","sorted","sort","key1","key2","Contacts","search","setSearch","setFilteredContacts","newFilteredContacts","addContact","x","setCurrentReceiver","groupMembers","createGroup","group","joinGroup","resJoin","resMembers","ContactView","index","selected","contactSelected","userIcon","fiberNewMargin","href","removeContact","r1","name","r2","welcome","list","vh60","ncpfcenter","Messenger","logout","querySelectorAll","elem","M","Tooltip","getInstance","sidenav","messengerContainer","cborder","sidenavIcon","data-target","App","AutoInit","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.c11461e8.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"border\":\"Contacts_border__Sf04J\",\"Contacts\":\"Contacts_Contacts__3HDS0\",\"btn\":\"Contacts_btn__3rFk_\",\"r1\":\"Contacts_r1__CpBqT\",\"search\":\"Contacts_search__3nW0o\",\"r2\":\"Contacts_r2__22Y0p\",\"welcome\":\"Contacts_welcome__3cnNw\",\"list\":\"Contacts_list__2UyNX\",\"vh60\":\"Contacts_vh60__2AyiT\",\"ncpfcenter\":\"Contacts_ncpfcenter__3ZrMW\",\"ContactView\":\"Contacts_ContactView__16gQn\",\"fiberNewMargin\":\"Contacts_fiberNewMargin__1MTQ_\",\"userIcon\":\"Contacts_userIcon__1i6OM\",\"contactSelected\":\"Contacts_contactSelected__2TcW-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"border\":\"MessengerMain_border__3eDiz\",\"MessengerMain\":\"MessengerMain_MessengerMain__G_my1\",\"image\":\"MessengerMain_image__3aedM\",\"header\":\"MessengerMain_header__2ce5m\",\"activeIconMargin\":\"MessengerMain_activeIconMargin__35ekG\",\"messageList\":\"MessengerMain_messageList__24Ksj\",\"scroll\":\"MessengerMain_scroll__1Ov-f\",\"input\":\"MessengerMain_input__1o1aS\",\"empty\":\"MessengerMain_empty__M478O\",\"ncscenter\":\"MessengerMain_ncscenter__1KKtL\",\"MessageView\":\"MessengerMain_MessageView__-1IED\",\"receiver\":\"MessengerMain_receiver__3XNND\",\"reimage\":\"MessengerMain_reimage__2S8mA\",\"sender\":\"MessengerMain_sender__1Wrs9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"border\":\"Notifier_border__3db_T\",\"Notifier\":\"Notifier_Notifier__2a7dZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"border\":\"Login_border__1D4hz\",\"Login\":\"Login_Login__WctD9\",\"loginContainer\":\"Login_loginContainer__2sYHN\",\"loginForm\":\"Login_loginForm__2Maah\",\"formMain\":\"Login_formMain__3rcaN\",\"loginHeader\":\"Login_loginHeader__12uTQ\",\"banner\":\"Login_banner__ZQscA\",\"error\":\"Login_error__1hpMK\",\"submitbtn\":\"Login_submitbtn__2BgvP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"border\":\"Messenger_border__2RQFR\",\"Messenger\":\"Messenger_Messenger__1OLXO\",\"messengerContainer\":\"Messenger_messengerContainer__22qNZ\",\"cborder\":\"Messenger_cborder__1xE_B\",\"sidenav\":\"Messenger_sidenav__m8nZf\",\"header\":\"Messenger_header__1xa1v\",\"logout\":\"Messenger_logout__35j93\",\"sidenavIcon\":\"Messenger_sidenavIcon__1kRWm\"};","export const FIREBIRD_SERVER: string = \"http://35.222.126.184\";\n\nexport const USER_PREFIX: string = \"user.\";\nexport const GROUP_PREFIX: string = \"group.\";\nexport const BROADCAST_GROUP: string = \"group.broadcast\";\nexport const USER_SERVER: string = \"user.firebird\";\nexport const PRIVATE_KEY_SUFFIX: string = \".private.key\";\nexport const PUBLIC_KEY_SUFFIX: string = \".public.key\";\nexport const CONTACTS_SUFFIX: string = \".contacts\";\nexport const SESSION_KEY: string = \"session.key\";\n\nexport const NEW_CONNECTION: string = \"new_connection\";\nexport const SEND_MESSAGE: string = \"send_message\";\nexport const RECV_MESSAGE: string = \"recv_message\";\nexport const ACK_MESSAGE: string = \"ack_message\";\nexport const USER_STATE_CHANGE: string = \"user_state_change\";\n\nexport const TYPE_TEXT: string = \"text\";\nexport const TYPE_ACK: string = \"ack\";\nexport const TYPE_IMAGE: string = \"image\";\n\nexport const MESSAGE_PENDING: string = \"message_pending\";\nexport const MESSAGE_SENT: string = \"message_sent\";\nexport const MESSAGE_FAILED: string = \"message_failed\";\n\nexport const FORM_IMAGE_KEY: string = \"form_image_key\";\n","import axios from \"axios\";\nimport { FIREBIRD_SERVER } from \"../constants\";\n\nconst API = axios.create({\n  baseURL: FIREBIRD_SERVER,\n  timeout: 1000,\n});\n\nexport default API;\n","import styles from \"./Notifier.module.scss\";\nimport { useState } from \"react\";\nimport Modal from \"react-modal\";\n\nconst modal = { open: () => {}, set: (text: string) => {} };\n\nconst customStyles = {\n  content: {\n    top: \"50%\",\n    left: \"50%\",\n    right: \"auto\",\n    bottom: \"auto\",\n    marginRight: \"-50%\",\n    transform: \"translate(-50%, -50%)\",\n  },\n  overlay: {\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n  },\n};\n\n// Make sure to bind modal to your appElement (http://reactcommunity.org/react-modal/accessibility/)\nModal.setAppElement(\"#root\");\n\nconst Notifier = (): JSX.Element => {\n  const [modalIsOpen, setIsOpen] = useState(false);\n  const [text, setText] = useState(\"\");\n\n  function openModal() {\n    setIsOpen(true);\n  }\n\n  modal.open = openModal;\n  modal.set = setText;\n\n  function closeModal() {\n    setIsOpen(false);\n  }\n\n  return (\n    <Modal\n      isOpen={modalIsOpen}\n      onRequestClose={closeModal}\n      style={customStyles}\n      contentLabel=\"firebird: notification\"\n    >\n      <div className={styles.Notifier}>\n        <div className=\"modal-content\">\n          <h3>{\"Something went wrong :(\"}</h3>\n          <h6>{text}</h6>\n        </div>\n      </div>\n    </Modal>\n  );\n};\n\nexport const modalNotify = (text: string): void => {\n  modal.set(text);\n  modal.open();\n};\n\nexport default Notifier;\n","const ActionTypes = {\n  LOAD_RSA_KEYS: \"LOAD_RSA_KEYS\",\n  SIGN_IN: \"SIGN_IN\",\n  SIGN_UP: \"SIGN_UP\",\n  LOAD_USER_LOCAL_STATE: \"LOAD_USER_LOCAL_STATE\",\n  UPDATE_CONTACTS: \"UPDATE_CONTACTS\",\n  SET_RECEIVER: \"SET_RECEIVER\",\n  LOGOUT: \"LOGOUT\",\n  NEW_MESSAGE: \"NEW_MESSAGE\",\n  SEND_NEW_MESSAGE: \"SEND_NEW_MESSAGE\",\n  SET_ACK_FLAG: \"SET_ACK_FLAG\",\n};\n\nexport default ActionTypes;\n","import { useContext, useEffect, useState } from \"react\";\nimport io from \"socket.io-client\";\nimport FirebirdContext, {\n  Message,\n  Contact,\n  isGroup,\n  Group,\n  isUser,\n  User,\n} from \"../../../FirebirdContext/FirebirdContext\";\nimport API from \"../../../API/API\";\nimport { modalNotify } from \"../../Notifier/Notifier\";\nimport styles from \"./MessengerMain.module.scss\";\nimport {\n  ACK_MESSAGE,\n  CONTACTS_SUFFIX,\n  GROUP_PREFIX,\n  MESSAGE_FAILED,\n  MESSAGE_PENDING,\n  MESSAGE_SENT,\n  RECV_MESSAGE,\n  SEND_MESSAGE,\n  FIREBIRD_SERVER,\n  TYPE_IMAGE,\n  TYPE_TEXT,\n  USER_PREFIX,\n  USER_SERVER,\n  USER_STATE_CHANGE,\n} from \"../../../constants\";\nimport ActionTypes from \"../../../FirebirdContext/ActionTypes\";\nimport crypto from \"crypto\";\nimport NodeRSA from \"node-rsa\";\n\nconst socket = io(FIREBIRD_SERVER, { transports: [\"websocket\"] });\n\nconst decrypt = (message: Message, privateKey: string | null): Message => {\n  if (message.receiver.startsWith(GROUP_PREFIX) || message.type !== TYPE_TEXT) {\n    return { ...message };\n  }\n  if (!privateKey) {\n    return { ...message };\n  }\n  try {\n    const key = new NodeRSA().importKey(privateKey, \"private\");\n    const res: Message = { ...message };\n    res.body = key.decrypt(res.body, \"utf8\");\n    return res;\n  } catch (err) {\n    modalNotify(\"Invalid private key.\");\n    return { ...message };\n  }\n};\n\nconst encrypt = (message: Message, publicKey: string | null): Message => {\n  if (message.receiver.startsWith(GROUP_PREFIX) || message.type !== TYPE_TEXT) {\n    return { ...message };\n  }\n  if (!publicKey) {\n    modalNotify(\"Invalid public key from sender.\");\n    return { ...message };\n  }\n  try {\n    const key = new NodeRSA().importKey(publicKey, \"public\");\n    const res: Message = { ...message };\n    res.body = key.encrypt(res.body, \"base64\");\n    return res;\n  } catch (err) {\n    modalNotify(\"Invalid public key from sender.\");\n    return { ...message };\n  }\n};\n\n// top ten bruh moment functions.\nexport const addMessages = (\n  contacts: Contact[],\n  messages: Message[],\n  privateKey: string | null,\n  sent: boolean\n): Contact[] => {\n  const res = [...contacts];\n  messages.forEach((message) => {\n    if (message.receiver && message.receiver.startsWith(GROUP_PREFIX)) {\n      const idx = res.findIndex((contact) => {\n        return (\n          isGroup(contact.user) && contact.user.groupName === message.receiver\n        );\n      });\n      if (idx === -1) {\n        const newGroup: Group = { groupName: message.receiver, members: [] };\n        res.push({ user: newGroup, messages: [{ ...message }], unread: !sent });\n      } else {\n        res[idx].messages.push(message);\n        res[idx].unread = !sent;\n      }\n    } else if (message.receiver && message.receiver === USER_SERVER) {\n    } else {\n      message = decrypt(message, privateKey);\n      const idx = res.findIndex((contact) => {\n        return (\n          isUser(contact.user) &&\n          contact.user.userName === (sent ? message.receiver : message.sender)\n        );\n      });\n      if (idx === -1) {\n        const newUser: User = {\n          userName: sent ? message.receiver : message.sender,\n          publicKey: null,\n          active: false,\n        };\n        res.push({ user: newUser, messages: [{ ...message }], unread: !sent });\n      } else {\n        res[idx].messages.push(message);\n        res[idx].unread = !sent;\n      }\n    }\n  });\n  return res;\n};\n\nconst updateScroll = (): void => {\n  const element = document.getElementById(\"scrolldiv\");\n  if (element) {\n    element.scrollTop = element.scrollHeight;\n  }\n};\n\nconst distinct = (messages: Message[]): Message[] => {\n  return [\n    ...new Map(messages.map((item: Message) => [item[\"id\"], item])).values(),\n  ];\n};\n\nconst MessengerMain = (): JSX.Element => {\n  const { state, dispatch } = useContext(FirebirdContext);\n  const [text, setText] = useState(\"\");\n  const [file, setFile] = useState<string | null>(null);\n\n  useEffect(() => {\n    updateScroll();\n  }, [state.contacts]);\n\n  const userPresent =\n    state.currentReceiver &&\n    state.contacts.filter((contact) => {\n      if (\n        isUser(contact.user) &&\n        contact.user.userName === state.currentReceiver\n      ) {\n        return true;\n      }\n      if (\n        isGroup(contact.user) &&\n        contact.user.groupName === state.currentReceiver\n      ) {\n        return true;\n      }\n      return false;\n    }).length !== 0;\n\n  const user =\n    userPresent &&\n    state.contacts.filter((contact) => {\n      if (\n        isUser(contact.user) &&\n        contact.user.userName === state.currentReceiver\n      ) {\n        return true;\n      }\n      if (\n        isGroup(contact.user) &&\n        contact.user.groupName === state.currentReceiver\n      ) {\n        return true;\n      }\n      return false;\n    })[0].user;\n  const userActive = isUser(user) && user.active;\n\n  const sendMessage = (data: string, type: string): void => {\n    if (data.length === 0) {\n      return;\n    }\n\n    const timestamp = Date.now();\n    const message: Message = {\n      timestamp: Date.now(),\n      id: crypto\n        .createHash(\"sha256\")\n        .update(timestamp + \".\" + state.auth.userName)\n        .digest(\"hex\"),\n      type: type,\n      sender: state.auth.userName ? state.auth.userName : \"\",\n      receiver: state.currentReceiver ? state.currentReceiver : \"\",\n      body: data,\n      status: MESSAGE_PENDING,\n    };\n    let publicKey = null;\n    const contact = state.contacts.filter((contact) => {\n      if (\n        isUser(contact.user) &&\n        contact.user.userName === state.currentReceiver\n      ) {\n        return true;\n      }\n      return false;\n    });\n    if (contact.length && isUser(contact[0].user)) {\n      publicKey = contact[0].user.publicKey;\n    }\n    socket.emit(\n      SEND_MESSAGE,\n      JSON.stringify({\n        userName: state.auth.userName,\n        sessionKey: state.auth.sessionKey,\n        message: { ...encrypt(message, publicKey), status: undefined },\n      })\n    );\n    dispatch({\n      type: ActionTypes.SEND_NEW_MESSAGE,\n      payload: message,\n    });\n    setText(\"\");\n  };\n\n  useEffect(() => {\n    if (!socket.connected) {\n      socket.connect();\n    }\n\n    socket.emit(\n      \"new_connection\",\n      JSON.stringify({\n        userName: state.auth.userName,\n        sessionKey: state.auth.sessionKey,\n      })\n    );\n\n    socket.on(RECV_MESSAGE, (data: any) => {\n      const message: Message = JSON.parse(data);\n      dispatch({ type: ActionTypes.NEW_MESSAGE, payload: message });\n    });\n\n    socket.on(ACK_MESSAGE, (data: any) => {\n      const message: Message = JSON.parse(data);\n      dispatch({ type: ActionTypes.SET_ACK_FLAG, payload: message });\n    });\n\n    socket.on(USER_STATE_CHANGE, (data: any) => {\n      console.log(\"user_state_change: \" + data);\n    });\n\n    return () => {\n      socket.close();\n    };\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    const getPendingMessages = async () => {\n      if (state.auth.userName && state.auth.sessionKey) {\n        try {\n          const res = await API.get(\n            `/api/pendingMessages?userName=${state.auth.userName}&sessionKey=${state.auth.sessionKey}`\n          );\n          const messages: Message[] = res.data.messageList;\n          const data = localStorage.getItem(\n            state.auth.userName + CONTACTS_SUFFIX\n          );\n          const contacts = data ? JSON.parse(data) : [];\n          const updatedContacts = addMessages(\n            contacts,\n            messages,\n            state.auth.privateKey,\n            false\n          );\n          dispatch({\n            type: ActionTypes.UPDATE_CONTACTS,\n            payload: updatedContacts,\n          });\n        } catch (err) {\n          if (err.response) {\n            switch (err.response.status) {\n              case 401:\n                modalNotify(\n                  \"Session key may have expired, please login again.\"\n                );\n                break;\n              default:\n                modalNotify(\"Something went wrong. Try again.\");\n                break;\n            }\n          } else {\n            modalNotify(\"Could not contact contact server.\");\n          }\n        }\n      }\n    };\n    getPendingMessages();\n  }, [\n    dispatch,\n    state.auth.sessionKey,\n    state.auth.userName,\n    state.auth.privateKey,\n  ]);\n\n  const reader = new FileReader();\n  reader.addEventListener(\"load\", () => {\n    if (reader.result) {\n      setFile(reader.result.toString());\n    }\n  });\n\n  useEffect(() => {\n    if (file) {\n      sendMessage(file, TYPE_IMAGE);\n      setFile(null);\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [file]);\n\n  const MessageView = (message: Message, key: number): JSX.Element => {\n    const MessageViewInner = (): JSX.Element => {\n      var icon: JSX.Element = <></>;\n      switch (message.status) {\n        case MESSAGE_PENDING:\n          icon = <i className=\"material-icons\">access_time</i>;\n          break;\n        case MESSAGE_FAILED:\n          icon = <i className=\"material-icons\">error</i>;\n          break;\n        case MESSAGE_SENT:\n          icon = <i className=\"material-icons\">check_circle</i>;\n          break;\n      }\n      var body: JSX.Element = <></>;\n      if (message.type === TYPE_TEXT && typeof message.body === \"string\") {\n        body = <>{message.body}</>;\n      } else if (\n        message.type === TYPE_IMAGE &&\n        typeof message.body === \"string\"\n      ) {\n        body = (\n          <>\n            <img\n              className={styles.image + \" materialboxed\"}\n              src={message.body}\n              alt=\"<>img data not loaded</>\"\n            />\n          </>\n        );\n      }\n\n      return (\n        <>\n          <p>\n            <i className=\"material-icons\">account_circle</i>\n            <small>{message.sender.replace(USER_PREFIX, \"\")}</small>\n          </p>\n          <p>{body}</p>\n          <p>\n            <small>{new Date(message.timestamp).toISOString()}</small>\n            <small className=\"right\">{icon}</small>\n          </p>\n        </>\n      );\n    };\n\n    return (\n      <div key={key} className={styles.MessageView}>\n        <div className=\"row\">\n          {message.sender !== state.auth.userName ? (\n            <div\n              className={\n                styles.receiver +\n                \" \" +\n                (message.type === TYPE_IMAGE ? styles.reimage : \"\") +\n                \" col l5 s8\"\n              }\n            >\n              <MessageViewInner />\n            </div>\n          ) : (\n            <div className={styles.sender + \" col l5 s8 offset-l7  offset-s4\"}>\n              <MessageViewInner />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className={styles.MessengerMain}>\n      {userPresent ? (\n        <div className={styles.header + \" row\"}>\n          <div className=\"col s12\">\n            <h5>\n              {state.currentReceiver?.startsWith(USER_PREFIX)\n                ? state.currentReceiver.replace(USER_PREFIX, \"\")\n                : state.currentReceiver?.replace(GROUP_PREFIX, \"\")}\n              {isUser(user) ? (\n                <i\n                  className={\n                    styles.activeIconMargin + \" material-icons tooltipped\"\n                  }\n                  data-position=\"bottom\"\n                  data-tooltip={userActive ? \"Active Now\" : \"Offline\"}\n                >\n                  {userActive ? \"notifications_active\" : \"notifications_paused\"}\n                </i>\n              ) : null}\n            </h5>\n          </div>\n        </div>\n      ) : (\n        \"\"\n      )}\n\n      {userPresent ? (\n        <div className={styles.messageList + \" row\"}>\n          <div id=\"scrolldiv\" className={styles.scroll + \" col s12\"}>\n            {distinct(\n              state.contacts.filter((contact) => {\n                if (\n                  isUser(contact.user) &&\n                  contact.user.userName === state.currentReceiver\n                ) {\n                  return true;\n                }\n                if (\n                  isGroup(contact.user) &&\n                  contact.user.groupName === state.currentReceiver\n                ) {\n                  return true;\n                }\n                return false;\n              })[0].messages\n            ).map(MessageView)}\n          </div>\n        </div>\n      ) : (\n        <div className=\"row\">\n          <div\n            className={styles.empty + \" col s12 valign-wrapper center-align\"}\n          >\n            <div className={styles.ncscenter}>\n              <h6>No contact selected.</h6>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {userPresent ? (\n        <div className={styles.input + \" row\"}>\n          <div className=\"col s12\">\n            <div className=\"row\">\n              <div className=\"col s8 l10 input-field\">\n                <input\n                  id=\"main-text-send\"\n                  type=\"text\"\n                  className=\"validate\"\n                  value={text}\n                  onChange={(e) => {\n                    setText(e.target.value);\n                  }}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\") {\n                      if (state.currentReceiver) {\n                        sendMessage(text, TYPE_TEXT);\n                      }\n                    }\n                  }}\n                />\n                <label htmlFor=\"main-text-send\">Type a message</label>\n              </div>\n              <div className=\"col l1 s2 center\">\n                <button\n                  className=\"btn\"\n                  onClick={() => {\n                    if (state.currentReceiver) {\n                      sendMessage(text, TYPE_TEXT);\n                    }\n                  }}\n                >\n                  <i className=\"material-icons\">send</i>\n                </button>\n              </div>\n              <div className=\"col l1 s2 center\">\n                <input\n                  id=\"imgupload\"\n                  type=\"file\"\n                  hidden\n                  onChange={(e) => {\n                    if (e.target.files && e.target.files.length) {\n                      reader.readAsDataURL(e.target.files[0]);\n                    } else {\n                      setFile(null);\n                    }\n                  }}\n                />\n                <button\n                  className=\"btn\"\n                  onClick={() => {\n                    const btn = document.getElementById(\"imgupload\");\n                    if (btn) {\n                      btn.click();\n                    }\n                  }}\n                >\n                  <i className=\"material-icons\">add_a_photo</i>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n};\n\nexport default MessengerMain;\n","import { createContext, Dispatch, useReducer } from \"react\";\nimport { addMessages } from \"../Components/Messenger/MessengerMain/MessengerMain\";\nimport {\n  CONTACTS_SUFFIX,\n  MESSAGE_FAILED,\n  MESSAGE_SENT,\n  PRIVATE_KEY_SUFFIX,\n  PUBLIC_KEY_SUFFIX,\n  SESSION_KEY,\n} from \"../constants\";\nimport ActionTypes from \"./ActionTypes\";\n\nexport interface User {\n  userName: string;\n  publicKey: string | null;\n  active: boolean;\n}\n\nexport const isUser = (o: any): o is User => {\n  return o && \"userName\" in o && \"publicKey\" in o && \"active\" in o;\n};\n\nexport interface Group {\n  groupName: string;\n  members: string[];\n}\n\nexport const isGroup = (o: any): o is Group => {\n  return o && \"groupName\" in o && \"members\" in o;\n};\n\nexport interface Message {\n  timestamp: number;\n  id: string;\n  type: string;\n  sender: string;\n  receiver: string;\n  body: any;\n  status?: string;\n}\n\nexport const isMessage = (o: any): o is Message => {\n  return (\n    o &&\n    \"timestamp\" in o &&\n    \"id\" in o &&\n    \"type\" in o &&\n    \"sender\" in o &&\n    \"receiver\" in o &&\n    \"body\" in o\n  );\n};\n\nexport interface Contact {\n  user: User | Group;\n  messages: Message[];\n  unread: boolean;\n}\n\nexport const isContact = (o: any): o is Contact => {\n  return o && \"user\" in o && \"messages\" in o;\n};\n\nexport interface FirebirdState {\n  auth: {\n    userName: string | null;\n    sessionKey: string | null;\n    privateKey: string | null;\n    publicKey: string | null;\n    hash: string | null;\n  };\n  contacts: Contact[];\n  currentReceiver: string | null;\n}\n\nexport const isFirebirdState = (o: any): o is FirebirdState => {\n  return (\n    \"auth\" in o &&\n    \"sessionKey\" in o.auth &&\n    \"privateKey\" in o.auth &&\n    \"publicKey\" in o.auth &&\n    \"hash\" in o.auth &&\n    \"contacts\" in o &&\n    \"currentReceiver\" in o\n  );\n};\n\nexport interface FirebirdContextAction {\n  type: string;\n  payload: any;\n}\n\nconst initState: FirebirdState = {\n  auth: {\n    userName: null,\n    sessionKey: null,\n    privateKey: null,\n    publicKey: null,\n    hash: null,\n  },\n  contacts: [],\n  currentReceiver: null,\n};\n\nconst FirebirdContext = createContext<{\n  state: FirebirdState;\n  dispatch: Dispatch<FirebirdContextAction>;\n}>({ state: initState, dispatch: () => null });\n\nexport const FirebirdContextReducer = (\n  state: FirebirdState,\n  action: FirebirdContextAction\n): FirebirdState => {\n  switch (action.type) {\n    case ActionTypes.SIGN_UP:\n      localStorage.setItem(\n        action.payload.userName + PRIVATE_KEY_SUFFIX,\n        action.payload.privateKey\n      );\n      localStorage.setItem(\n        action.payload.userName + PUBLIC_KEY_SUFFIX,\n        action.payload.publicKey\n      );\n      return { ...state, auth: { ...state.auth, ...action.payload } };\n    case ActionTypes.LOAD_RSA_KEYS:\n      return { ...state, auth: { ...state.auth, ...action.payload } };\n    case ActionTypes.SIGN_IN:\n      return { ...state, auth: { ...state.auth, ...action.payload } };\n    case ActionTypes.LOAD_USER_LOCAL_STATE:\n      return { ...state, contacts: [...action.payload] };\n    case ActionTypes.UPDATE_CONTACTS:\n      localStorage.setItem(\n        state.auth.userName + CONTACTS_SUFFIX,\n        JSON.stringify(action.payload)\n      );\n      return { ...state, contacts: [...action.payload] };\n    case ActionTypes.SET_RECEIVER:\n      const contacts = state.contacts.map((contact) => {\n        if (\n          isUser(contact.user) &&\n          contact.user.userName === action.payload.currentReceiver\n        ) {\n          return {\n            ...contact,\n            user: {\n              ...contact.user,\n              publicKey: action.payload.publicKey\n                ? action.payload.publicKey\n                : contact.user.publicKey,\n              active: action.payload.active,\n            },\n            unread: false,\n          };\n        } else if (\n          isGroup(contact.user) &&\n          contact.user.groupName === action.payload.currentReceiver\n        ) {\n          return {\n            ...contact,\n            user: {\n              ...contact.user,\n              members: [...action.payload.members],\n            },\n            unread: false,\n          };\n        } else {\n          return contact;\n        }\n      });\n      localStorage.setItem(\n        state.auth.userName + CONTACTS_SUFFIX,\n        JSON.stringify(contacts)\n      );\n      return {\n        ...state,\n        currentReceiver: action.payload.currentReceiver,\n        contacts: contacts,\n      };\n    case ActionTypes.NEW_MESSAGE:\n      const contactsNM = addMessages(\n        state.contacts,\n        [action.payload],\n        state.auth.privateKey,\n        false\n      );\n      localStorage.setItem(\n        state.auth.userName + CONTACTS_SUFFIX,\n        JSON.stringify(contactsNM)\n      );\n      return { ...state, contacts: [...contactsNM] };\n    case ActionTypes.SEND_NEW_MESSAGE:\n      const contactsSNM = addMessages(\n        state.contacts,\n        [action.payload],\n        null,\n        true\n      );\n      localStorage.setItem(\n        state.auth.userName + CONTACTS_SUFFIX,\n        JSON.stringify(contactsSNM)\n      );\n      return { ...state, contacts: [...contactsSNM] };\n    case ActionTypes.SET_ACK_FLAG:\n      const contactsSAF = state.contacts.map((contact: Contact) => {\n        return {\n          ...contact,\n          messages: contact.messages.map((message: Message) => {\n            if (message.id === action.payload.id) {\n              return {\n                ...message,\n                status: action.payload.body ? MESSAGE_SENT : MESSAGE_FAILED,\n              };\n            } else {\n              return message;\n            }\n          }),\n        };\n      });\n      localStorage.setItem(\n        state.auth.userName + CONTACTS_SUFFIX,\n        JSON.stringify(contactsSAF)\n      );\n      return { ...state, contacts: [...contactsSAF] };\n    case ActionTypes.LOGOUT:\n      sessionStorage.removeItem(SESSION_KEY);\n      return { ...state, auth: { ...state.auth, sessionKey: action.payload } };\n    default:\n      return state;\n  }\n};\n\nexport const FirebirdContextProvider = (props: any): JSX.Element => {\n  const [state, dispatch] = useReducer(FirebirdContextReducer, initState);\n  return (\n    <FirebirdContext.Provider value={{ state, dispatch }}>\n      {props.children}\n    </FirebirdContext.Provider>\n  );\n};\n\nexport default FirebirdContext;\n","import { useContext, useEffect, useState } from \"react\";\nimport FirebirdContext from \"../../FirebirdContext/FirebirdContext\";\nimport NodeRsa from \"node-rsa\";\nimport crypto from \"crypto\";\nimport styles from \"./Login.module.scss\";\nimport API from \"../../API/API\";\nimport ActionTypes from \"../../FirebirdContext/ActionTypes\";\nimport {\n  PRIVATE_KEY_SUFFIX,\n  PUBLIC_KEY_SUFFIX,\n  SESSION_KEY,\n  USER_PREFIX,\n} from \"../../constants\";\n\nconst Login = (): JSX.Element => {\n  const { state, dispatch } = useContext(FirebirdContext);\n  const [userName, setUserName] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  useEffect(() => {\n    const privateKey = localStorage.getItem(\n      USER_PREFIX + userName + PRIVATE_KEY_SUFFIX\n    );\n    const publicKey = localStorage.getItem(\n      USER_PREFIX + userName + PUBLIC_KEY_SUFFIX\n    );\n    if (privateKey && publicKey) {\n      const hash = crypto.createHash(\"sha256\").update(privateKey).digest(\"hex\");\n      dispatch({\n        type: ActionTypes.LOAD_RSA_KEYS,\n        payload: { privateKey, publicKey, hash },\n      });\n    } else {\n      dispatch({\n        type: ActionTypes.LOAD_RSA_KEYS,\n        payload: { privateKey: null, publicKey: null, hash: null },\n      });\n    }\n  }, [dispatch, userName]);\n\n  const onSignIn = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErrorMessage(\"\");\n    const hash = state.auth.hash;\n    if (hash) {\n      try {\n        setErrorMessage(\"Signing you in...\");\n        const res = await API.post(\"/api/validateUser\", {\n          userName: USER_PREFIX + userName,\n          hash: hash,\n        });\n        sessionStorage.setItem(\n          SESSION_KEY,\n          JSON.stringify({\n            ...state.auth,\n            sessionKey: res.data.sessionKey,\n            userName: res.data.userName,\n          })\n        );\n        dispatch({\n          type: ActionTypes.SIGN_IN,\n          payload: {\n            userName: res.data.userName,\n            sessionKey: res.data.sessionKey,\n          },\n        });\n      } catch (err) {\n        if (err.response) {\n          switch (err.response.status) {\n            case 401:\n              setErrorMessage(\"Authentication failed.\");\n              break;\n            default:\n              setErrorMessage(\"Something went wrong. Try again.\");\n          }\n        } else {\n          setErrorMessage(\"Could not contact server. Try again.\");\n        }\n      }\n    } else {\n      setErrorMessage(\"RSA credentials not found in local storage.\");\n    }\n  };\n\n  const onSignUp = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErrorMessage(\"\");\n    const key = new NodeRsa({ b: 512 });\n    const publicKey = key.exportKey(\"public\");\n    const privateKey = key.exportKey(\"private\");\n    const hash = crypto.createHash(\"sha256\").update(privateKey).digest(\"hex\");\n    try {\n      setErrorMessage(\"Creating new user...\");\n      const res = await API.post(\"/api/createUser\", {\n        userName: USER_PREFIX + userName,\n        hash: hash,\n        publicKey: publicKey,\n      });\n      dispatch({\n        type: ActionTypes.SIGN_UP,\n        payload: {\n          userName: res.data.userName,\n          privateKey: privateKey,\n          publicKey: publicKey,\n          hash: hash,\n        },\n      });\n      setErrorMessage(\"User created.\");\n    } catch (err) {\n      if (err.response) {\n        switch (err.response.status) {\n          case 401:\n            setErrorMessage(\"User already exists.\");\n            break;\n          default:\n            setErrorMessage(\"Something went wrong. Try again.\");\n        }\n      } else {\n        setErrorMessage(\"Could not contact server. Try again.\");\n      }\n    }\n  };\n\n  return (\n    <div className={styles.Login}>\n      <div className={styles.loginContainer + \" row\"}>\n        <div\n          className={\n            styles.banner + \" col l8 m6 hide-on-small-only valign-wrapper\"\n          }\n        >\n          <div className=\"col m11 offset-m1\">\n            <h1>Introducing firebird.</h1>\n            <h5>A Fast end-to-end Encrypted Messenger</h5>\n            <p>\n              No more remembering passwords. <br />\n              Password-less authentication using asymmetric key pairs for one\n              tap <br />\n              login and signing up. <br />\n            </p>\n            <p>\n              All user information is persisted client-side. <br />\n            </p>\n          </div>\n        </div>\n        <div className={styles.loginForm + \" col l4 m6 s12 valign-wrapper\"}>\n          <form className={styles.formMain}>\n            <div className={styles.loginHeader + \" row\"}>\n              <h1>firebird</h1>\n              <h6>Secured by RSA end-to-end Encryption</h6>\n            </div>\n            <div className=\"row\">\n              <div className=\"input-field col s8 offset-s2\">\n                <input\n                  id=\"user\"\n                  type=\"text\"\n                  className=\"validate\"\n                  onChange={(e) => {\n                    setUserName(e.target.value);\n                    setErrorMessage(\"\");\n                  }}\n                  value={userName}\n                />\n                <label htmlFor=\"user\">Username: </label>\n                <span className={styles.error + \" helper-text\"}>\n                  {errorMessage}\n                </span>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col m3 offset-m3 s4 offset-s2 center\">\n                <button\n                  className={styles.submitbtn + \" btn\"}\n                  onClick={onSignIn}\n                >\n                  Login\n                </button>\n              </div>\n              <div className=\"col m3 s4 center\">\n                <button\n                  className={styles.submitbtn + \" btn\"}\n                  onClick={onSignUp}\n                >\n                  Join\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n","import { useContext, useEffect, useState } from \"react\";\nimport API from \"../../../API/API\";\nimport { GROUP_PREFIX, USER_PREFIX } from \"../../../constants\";\nimport ActionTypes from \"../../../FirebirdContext/ActionTypes\";\nimport FirebirdContext, {\n  Contact,\n  Group,\n  isGroup,\n  isUser,\n} from \"../../../FirebirdContext/FirebirdContext\";\nimport { modalNotify } from \"../../Notifier/Notifier\";\nimport styles from \"./Contacts.module.scss\";\n\nconst sortOrder = (filteredContacts: Contact[]): Contact[] => {\n  const sorted = [...filteredContacts];\n  sorted.sort((a: Contact, b: Contact): number => {\n    if (a.messages.length === 0 && a.messages.length === 0) {\n      return 0;\n    }\n    if (a.messages.length === 0) {\n      return 1;\n    }\n    if (b.messages.length === 0) {\n      return -1;\n    }\n    const key1 = a.messages[a.messages.length - 1].timestamp;\n    const key2 = b.messages[b.messages.length - 1].timestamp;\n    if (key1 < key2) {\n      return 1;\n    } else if (key1 > key2) {\n      return -1;\n    }\n    return 0;\n  });\n  return sorted;\n};\n\nconst Contacts = (props: any): JSX.Element => {\n  const { state, dispatch } = useContext(FirebirdContext);\n  const [search, setSearch] = useState(\"\");\n  const [filteredContacts, setFilteredContacts] = useState(state.contacts);\n\n  useEffect(() => {\n    const newFilteredContacts = state.contacts.filter((contact) => {\n      if (\n        isUser(contact.user) &&\n        contact.user.userName.startsWith(USER_PREFIX + search)\n      ) {\n        return true;\n      }\n      if (\n        isGroup(contact.user) &&\n        contact.user.groupName.startsWith(GROUP_PREFIX + search)\n      ) {\n        return true;\n      }\n      return false;\n    });\n    setFilteredContacts(newFilteredContacts);\n  }, [state.contacts, search]);\n\n  const addContact = async (user: string) => {\n    user = USER_PREFIX + user;\n    const alreadyExists = state.contacts.filter(\n      (x) => isUser(x.user) && x.user.userName === user\n    );\n    if (alreadyExists.length) {\n      return;\n    }\n    try {\n      const res = await API.get(\n        `/api/publicKey?userName=${state.auth.userName}&sessionKey=${state.auth.sessionKey}&user=${user}`\n      );\n      const contact: Contact = {\n        user: {\n          userName: user,\n          publicKey: res.data.publicKey,\n          active: false,\n        },\n        messages: [],\n        unread: false,\n      };\n      const contacts = state.contacts;\n      contacts.push(contact);\n      dispatch({ type: ActionTypes.UPDATE_CONTACTS, payload: contacts });\n      setSearch(\"\");\n    } catch (err) {\n      if (err.response) {\n        switch (err.response.status) {\n          case 401:\n            modalNotify(\"Invalid username.\");\n            break;\n          default:\n            modalNotify(\"Something went wrong. Try again.\");\n        }\n      } else {\n        modalNotify(\"Could not contact server. Try again.\");\n      }\n    }\n  };\n\n  const removeContact = (user: string) => {\n    const contacts = state.contacts.filter((x) => {\n      if (isUser(x.user) && x.user.userName === user) {\n        return false;\n      } else if (isGroup(x.user) && x.user.groupName === user) {\n        return false;\n      }\n      return true;\n    });\n    dispatch({\n      type: ActionTypes.UPDATE_CONTACTS,\n      payload: contacts,\n    });\n  };\n\n  const setCurrentReceiver = async (user: string) => {\n    let active: boolean = false;\n    let publicKey: string | null = null;\n    let members: string[] = [];\n    const contacts = state.contacts.filter((x) => {\n      if (isUser(x.user) && x.user.userName === user) {\n        return true;\n      } else if (isGroup(x.user) && x.user.groupName === user) {\n        return true;\n      }\n      return false;\n    });\n    if (contacts.length) {\n      const contact = contacts[0];\n      if (isUser(contact.user)) {\n        if (!contact.user.publicKey) {\n          try {\n            const res = await API.get(\n              `/api/publicKey?userName=${state.auth.userName}&sessionKey=${state.auth.sessionKey}&user=${user}`\n            );\n            publicKey = res.data.publicKey;\n          } catch (err) {\n            if (err.response) {\n              switch (err.response) {\n                case 401:\n                  modalNotify(\n                    \"Session key may have expired, please login again.\"\n                  );\n                  break;\n                default:\n                  modalNotify(\"Something went wrong. Try again.\");\n              }\n            } else {\n              modalNotify(\"Could not contact contact server.\");\n            }\n          }\n        }\n        try {\n          const res = await API.get(\n            `/api/userActive?userName=${state.auth.userName}&sessionKey=${state.auth.sessionKey}&user=${user}`\n          );\n          active = res.data.active;\n        } catch (err) {\n          if (err.response) {\n            switch (err.response) {\n              case 401:\n                modalNotify(\n                  \"Session key may have expired, please login again.\"\n                );\n                break;\n              default:\n                modalNotify(\"Something went wrong. Try again.\");\n            }\n          } else {\n            modalNotify(\"Could not contact contact server.\");\n          }\n        }\n      } else {\n        try {\n          const res = await API.get(\n            `/api/groupMembers?userName=${state.auth.userName}&sessionKey=${state.auth.sessionKey}&groupName=${user}`\n          );\n          members = res.data.groupMembers;\n        } catch (err) {\n          if (err.response) {\n            switch (err.response) {\n              case 401:\n                modalNotify(\n                  \"Session key may have expired, please login again.\"\n                );\n                break;\n              default:\n                modalNotify(\"Something went wrong. Try again.\");\n            }\n          } else {\n            modalNotify(\"Could not contact contact server.\");\n          }\n        }\n      }\n    }\n    dispatch({\n      type: ActionTypes.SET_RECEIVER,\n      payload: { currentReceiver: user, active, publicKey, members },\n    });\n  };\n\n  const createGroup = async (group: string) => {\n    group = GROUP_PREFIX + group;\n    try {\n      const res = await API.post(\"/api/createGroup\", {\n        userName: state.auth.userName,\n        sessionKey: state.auth.sessionKey,\n        groupName: group,\n      });\n      const newGroup: Group = { groupName: res.data.groupName, members: [] };\n      if (state.auth.userName) {\n        newGroup.members.push(state.auth.userName);\n      }\n      const contacts = state.contacts;\n      contacts.push({ user: newGroup, messages: [], unread: false });\n      dispatch({ type: ActionTypes.UPDATE_CONTACTS, payload: contacts });\n      setSearch(\"\");\n    } catch (err) {\n      if (err.response) {\n        switch (err.response.status) {\n          case 401:\n            modalNotify(\"Group already exists.\");\n            break;\n          default:\n            modalNotify(\"Something went wrong. Try again.\");\n        }\n      } else {\n        modalNotify(\"Could not contact server. Try again.\");\n      }\n    }\n  };\n\n  const joinGroup = async (group: string) => {\n    group = GROUP_PREFIX + group;\n    const alreadyExists = state.contacts.filter(\n      (x) => isGroup(x.user) && x.user.groupName === group\n    );\n    if (alreadyExists.length) {\n      return;\n    }\n    try {\n      const resJoin = await API.post(\"/api/joinGroup\", {\n        userName: state.auth.userName,\n        sessionKey: state.auth.sessionKey,\n        groupName: group,\n      });\n      const resMembers = await API.get(\n        `/api/groupMembers?userName=${state.auth.userName}&groupName=${group}&sessionKey=${state.auth.sessionKey}`\n      );\n      const newGroup: Group = {\n        groupName: resJoin.data.groupName,\n        members: resMembers.data.groupMembers,\n      };\n      const contacts = state.contacts;\n      contacts.push({ user: newGroup, messages: [], unread: false });\n      dispatch({ type: ActionTypes.UPDATE_CONTACTS, payload: contacts });\n      setSearch(\"\");\n    } catch (err) {\n      if (err.response) {\n        switch (err.response.status) {\n          case 401:\n            modalNotify(\"Group does not exist\");\n            break;\n          default:\n            modalNotify(\"Something went wrong. Try again.\");\n        }\n      } else {\n        modalNotify(\"Could not contact server. Try again.\");\n      }\n    }\n  };\n\n  const ContactView = (\n    contact: Contact,\n    index: number,\n    selected: boolean\n  ): JSX.Element => {\n    return (\n      <li key={index} className={styles.ContactView}>\n        <div>\n          <button\n            className={(selected ? styles.contactSelected : \"\") + \" btn\"}\n            onClick={() => {\n              setCurrentReceiver(\n                isUser(contact.user)\n                  ? contact.user.userName\n                  : contact.user.groupName\n              );\n            }}\n          >\n            <i className={styles.userIcon + \" large material-icons left\"}>\n              {isUser(contact.user) ? \"account_circle\" : \"group\"}\n            </i>\n            {isUser(contact.user)\n              ? contact.user.userName.replace(USER_PREFIX, \"\")\n              : contact.user.groupName.replace(GROUP_PREFIX, \"\")}\n            {contact.unread ? (\n              <i className={styles.fiberNewMargin + \" material-icons\"}>\n                fiber_new\n              </i>\n            ) : null}\n            <a\n              className=\"right\"\n              href=\"#react\"\n              onClick={() =>\n                removeContact(\n                  isUser(contact.user)\n                    ? contact.user.userName\n                    : contact.user.groupName\n                )\n              }\n            >\n              <i className=\"material-icons\">close</i>\n            </a>\n          </button>\n        </div>\n      </li>\n    );\n  };\n\n  return (\n    <div className={styles.Contacts + \" row\"}>\n      <div className=\"col s12\">\n        <div className={styles.r1 + \" row\"}>\n          <div className=\"col s12 m10 offset-m1 input-field\">\n            <i className=\"material-icons prefix\">search</i>\n            <input\n              id={props.name}\n              type=\"text\"\n              className=\"validate\"\n              onChange={(e) => {\n                setSearch(e.target.value);\n              }}\n              value={search}\n            />\n            <label htmlFor={props.name}>Search or add new contacts</label>\n          </div>\n        </div>\n        <div className={styles.r2 + \" row\"}>\n          <div className=\"col s12 m10 offset-m1\">\n            <div className=\"row\">\n              <div className={styles.welcome + \" col s8 m9\"}>\n                <h6>\n                  Welcome, {state.auth.userName?.replace(USER_PREFIX, \"\")}\n                </h6>\n              </div>\n              <div className=\"col s1 center\">\n                <button\n                  type=\"button\"\n                  data-position=\"bottom\"\n                  data-tooltip=\"Add contact\"\n                  className={styles.btn + \" btn btn-small tooltipped\"}\n                  onClick={() => {\n                    addContact(search);\n                  }}\n                >\n                  <i className=\"material-icons\">person_add</i>\n                </button>\n              </div>\n              <div className=\"col s1 center\">\n                <button\n                  type=\"button\"\n                  data-position=\"top\"\n                  data-tooltip=\"Create group\"\n                  className={styles.btn + \" btn btn-small tooltipped\"}\n                  onClick={() => createGroup(search)}\n                >\n                  <i className=\"material-icons\">group_add</i>\n                </button>\n              </div>\n              <div className=\"col s1 center\">\n                <button\n                  type=\"button\"\n                  data-position=\"bottom\"\n                  data-tooltip=\"Join group\"\n                  className={styles.btn + \" btn btn-small tooltipped\"}\n                  onClick={() => joinGroup(search)}\n                >\n                  <i className=\"material-icons\">groups</i>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <ul className={styles.list}>\n          {filteredContacts.length ? (\n            sortOrder(filteredContacts).map((contact, index) =>\n              ContactView(\n                contact,\n                index,\n                state.currentReceiver ===\n                  (isUser(contact.user)\n                    ? contact.user.userName\n                    : contact.user.groupName)\n              )\n            )\n          ) : (\n            <div className={styles.vh60 + \" valign-wrapper center-align\"}>\n              <div className={styles.ncpfcenter}>\n                <h6>No contacts for applied filter</h6>\n              </div>\n            </div>\n          )}\n        </ul>\n      </div>\n    </div>\n  );\n};\n\nexport default Contacts;\n","import { useContext } from \"react\";\nimport ActionTypes from \"../../FirebirdContext/ActionTypes\";\nimport FirebirdContext from \"../../FirebirdContext/FirebirdContext\";\nimport Contacts from \"./Contacts/Contacts\";\nimport MessengerMain from \"./MessengerMain/MessengerMain\";\nimport styles from \"./Messenger.module.scss\";\n\nconst Messenger = (): JSX.Element => {\n  const { dispatch } = useContext(FirebirdContext);\n\n  const logout = () => {\n    const elems = document.querySelectorAll(\".tooltipped\");\n    elems.forEach((elem) => {\n      const instance = M.Tooltip.getInstance(elem);\n      instance.close();\n    });\n    dispatch({ type: ActionTypes.LOGOUT, payload: null });\n  };\n\n  return (\n    <div className={styles.Messenger}>\n      <div className=\"hide-on-med-and-up\">\n        <div id=\"slide-out\" className={styles.sidenav + \" sidenav\"}>\n          <div className={styles.header + \" row\"}>\n            <div className=\"col m11 s10\">\n              <h2>firebird</h2>\n            </div>\n            <div className={styles.logout + \" col  m1 s2\"}>\n              <a\n                href=\"#react\"\n                className=\"tooltipped\"\n                data-position=\"bottom\"\n                data-tooltip=\"Logout\"\n                onClick={logout}\n              >\n                <i className=\"material-icons\">exit_to_app</i>\n              </a>\n            </div>\n          </div>\n          <Contacts name=\"sidenav\" />\n        </div>\n      </div>\n      <div className={styles.messengerContainer + \" row\"}>\n        <div className={styles.cborder + \" col l4 m6 hide-on-small-only\"}>\n          <div className={styles.header + \" row\"}>\n            <div className=\"col m11 s10\">\n              <h2>firebird</h2>\n            </div>\n            <div className={styles.logout + \" col m1 s2\"}>\n              <a\n                href=\"#react\"\n                className=\"tooltipped\"\n                data-position=\"bottom\"\n                data-tooltip=\"Logout\"\n                onClick={logout}\n              >\n                <i className=\"material-icons\">exit_to_app</i>\n              </a>\n            </div>\n          </div>\n          <Contacts name=\"main\" />\n        </div>\n        <div className=\"col l8 m6 s12\">\n          <div className={styles.sidenavIcon + \" row hide-on-med-and-up\"}>\n            <a\n              href=\"#react\"\n              data-target=\"slide-out\"\n              className=\"sidenav-trigger\"\n            >\n              <i className=\"material-icons\">menu</i>\n            </a>\n          </div>\n          <MessengerMain />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Messenger;\n","import FirebirdContext from \"./FirebirdContext/FirebirdContext\";\nimport { useContext, useEffect } from \"react\";\nimport Login from \"./Components/Login/Login\";\nimport Messenger from \"./Components/Messenger/Messenger\";\nimport M from \"materialize-css\";\nimport { SESSION_KEY } from \"./constants\";\nimport ActionTypes from \"./FirebirdContext/ActionTypes\";\nimport Notifier from \"./Components/Notifier/Notifier\";\n\nconst App = (): JSX.Element => {\n  const { state, dispatch } = useContext(FirebirdContext);\n\n  useEffect(() => {\n    M.AutoInit();\n  });\n\n  useEffect(() => {\n    const data = sessionStorage.getItem(SESSION_KEY);\n    if (data) {\n      const auth = JSON.parse(data);\n      dispatch({ type: ActionTypes.SIGN_IN, payload: auth });\n    }\n  }, [dispatch]);\n\n  return (\n    <>\n      {state.auth.sessionKey ? <Messenger /> : <Login />}\n      <Notifier />\n    </>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport { FirebirdContextProvider } from \"./FirebirdContext/FirebirdContext\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <FirebirdContextProvider>\n      <App />\n    </FirebirdContextProvider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}